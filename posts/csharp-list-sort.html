<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" as="image" href="/assets/img/101night.avif" fetchpriority="high">
  <link rel="preload" as="style" href='/scss/clean-blog-min.css'/>

    <meta name="description" content="Dotnet C# List Sort &#x5404;&#x7A2E;&#x6392;&#x5E8F;&#x7528;&#x6CD5;">

  <title>Dotnet C# List Sort &#x5404;&#x7A2E;&#x7528;&#x6CD5;</title>


  <link rel="canonical" href='https://blog.allengaodev.com/posts/csharp-list-sort'>

      <link type="application/rss+xml" rel="alternate" title="&#x958B;&#x767C;&#x7A7A;&#x9593;" href="/feed.rss" />
      <link type="application/atom+xml" rel="alternate" title="&#x958B;&#x767C;&#x7A7A;&#x9593;" href="/feed.atom" />

  <meta name="application-name" content='Gao.Dev' />
  <meta name="msapplication-tooltip" content='Gao.Dev' />
  <meta name="msapplication-starturl" content='/' />
  <meta name="google-site-verification" content="aq71qXzppLuXZ8be8mjOwn_zJq317ZSD34yTS4i6y6M" />
  <meta property="og:title" content='Dotnet C# List Sort &#x5404;&#x7A2E;&#x7528;&#x6CD5;' />
    <meta property="og:image" content='/assets/img/101night.avif' />
  <meta property="og:type" content="website" />
  <meta property="og:url" content='https://blog.allengaodev.com/posts/csharp-list-sort' />

  <link rel="icon" href='/favicon.svg'>

  <!-- Styles for this template (also includes Bootstrap) -->
  <link href='/scss/clean-blog-min.css' rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" rel="stylesheet" media="print" onload="this.media='all'">

  


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav" style="background-color: #F5F1E6">
  <div class="container">
    <a class="navbar-brand text-dark" href='/'> Home </a>
    <button class="navbar-toggler navbar-toggler-right text-dark" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto">
          <li class="nav-item">
    <a class="nav-link text-dark" href="/search">Search</a>
  </li>
  <li class="nav-item">
    <a class="nav-link text-dark" href="/posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link text-dark" href="/tags">Tags</a>
  </li>

      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->
  <header class="masthead" style="background-image: url(&quot;/assets/img/101night.avif&quot;)">
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12">
        <div class='post-heading'>
          <h1>
            <a style="color:white" href='https://blog.allengaodev.com/posts/csharp-list-sort'>Dotnet C# List Sort &#x5404;&#x7A2E;&#x7528;&#x6CD5;</a>
          </h1>
            <p class="post-meta">
              <a style="line-height: 1.8em;padding-left: 1.6em;background-size: auto 100%;background-repeat: no-repeat; background-image:url(/calendar.svg)">
                2023/03/06
              </a>

                <a style="line-height: 1.8em;padding-left: 1.6em;background-size: auto 100%;background-repeat: no-repeat; background-image:url(/overtime.svg)">
                  2025/12/15
                </a>
            </p>
              <div class="mt-3">
                  <a href="/tags/dotnet" class="badge bg-white text-dark"> Dotnet</a>
                  <a href="/tags/csharp" class="badge bg-white text-dark"> CSharp</a>
              </div>
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <main id="main-content">
    <div class="container">
      <div class="row">
        <div id="content" class="col-md-12">
          <h2 id="net-sort">.Net Sort</h2>
<p>今天來複習一下 .Net 中排序的各種用法，首先是最簡單的由小到大排序</p>
<p>使用 Sort 方法可以直接將資料做正向排序，由於 Generic List 集合是屬於可變集合，因此 <code>Sort</code> 方法呼叫後會直接修改 <code>myList</code> 內容。</p>
<pre><code class="language-csharp">var myList = new List&lt;int&gt;() { 1, 7, 4, 2, 6, 3 };
myList.Sort();
</code></pre>
<p>另外 Immutable List 集合是屬於不可變集合，因此 <code>Sort</code> 方法不會修改原集合，而是回傳一個新的 ImmutableList 物件，因此需要重新指派。</p>
<pre><code class="language-csharp">var myList = ImmutableList.Create(1, 7, 4, 2, 6, 3);
myList = myList.Sort();
</code></pre>
<p>反向排序也很簡單，可以先呼叫 Sort 方法，之後在呼叫一次 Reverse 方法，可讀性會比較高。
也可以直接傳入客製的比較器，能夠做到一步倒序。</p>
<pre><code class="language-csharp">var myList = new List&lt;int&gt;() { 1, 7, 4, 2, 6, 3 };
myList.Sort();
myList.Reverse();

var myList = new List&lt;int&gt;() { 1, 7, 4, 2, 6, 3 };
myList.Sort((a, b) =&gt; b.CompareTo(a));
</code></pre>
<hr />
<h2 id="linq-lambda-expression-and-linq-query-expression">LINQ Lambda Expression And LINQ Query Expression</h2>
<p>使用 Lambda 表達式的 <code>OrderBy</code>、<code>ThenBy</code>、<code>OrderByDescending</code>、<code>ThenByDescending</code>擴充方法，
不直接修改原集合，而是回傳 <code>OrderedEnumerable</code> 集合，特性是擁有 <code>Lazy</code> 特性，代表只有在 enumerate 結果的時候才會真正進行排序。</p>
<pre><code class="language-csharp">void Main()
{
	var users = new List&lt;User&gt;()
	{
		new User(&quot;Charlie&quot;, 31),
		new User(&quot;Bob&quot;, 35),
		new User(&quot;Eve&quot;, 34),
		new User(&quot;David&quot;, 24),
		new User(&quot;Alice&quot;, 24)
	};

	// 先按照 Age 排，再按照 Name 排
	var orderUser = users
		.OrderBy(p =&gt; p.Age)
		.ThenBy(p =&gt; p.Name);

	// 先按照 Age 倒序排，再按照 Name 倒序排
	var orderUser1 = users
		.OrderByDescending(p =&gt; p.Age)
		.ThenByDescending(p =&gt; p.Name);

    // 因為有 Lazy 特性，所以需要增加下面這兩行正式取值，否則就不會做任何事情。
	Console.WriteLine($&quot;{orderUser.First().Name} ({orderUser.First().Age})&quot;);
	Console.WriteLine($&quot;{orderUser1.First().Name} ({orderUser1.First().Age})&quot;);
}

public record User(string Name, int Age);
</code></pre>
<p>另外也可以使用 Query 表達式，在一些複雜的排序場合下可讀性會比較高</p>
<pre><code class="language-text">void Main()
{
	var users = new List&lt;User&gt;()
	{
		new User(&quot;Charlie&quot;, 31),
		new User(&quot;Bob&quot;, 35),
		new User(&quot;Eve&quot;, 34),
		new User(&quot;David&quot;, 24),
		new User(&quot;Alice&quot;, 24)
	};

	// 先按照 Age 排，再按照 Name 排
	var orderUser = from p in users
					orderby p.Age, p.Name
					select p;

	// 先按照 Age 倒序排，再按照 Name 倒序排
	var orderUser1 = from p in users
					 orderby p.Age descending, p.Name descending
					 select p;

	// 因為有 Lazy 特性，所以需要增加下面這兩行正式取值，否則就不會做任何事情。
	Console.WriteLine($&quot;{orderUser.First().Name} ({orderUser.First().Age})&quot;);
	Console.WriteLine($&quot;{orderUser1.First().Name} ({orderUser1.First().Age})&quot;);
}

public record User(string Name, int Age);
</code></pre>
<hr />
<h2 id="string-sort">String Sort</h2>
<p>在 C# 中排序字串時，同樣可以使用 <code>Sort()</code> 方法，需要注意的是，預設排序會依照系統的 CultureInfo 進行，並不一定是 ASCII 排序。</p>
<p>因此 C# 提供了 <code>StringComparer</code> 類別，能讓我們統一控制不同文化排序方式，例如:</p>
<ol>
<li>StringComparer.Ordinal：按 ASCII 值排序，與文化無關。</li>
<li>StringComparer.OrdinalIgnoreCase：按 ASCII 排序，忽略大小寫。</li>
<li>StringComparer.CurrentCulture：根據目前系統文化排序。</li>
<li>StringComparer.CurrentCultureIgnoreCase：根據目前系統文化排序，忽略大小寫。</li>
<li>StringComparer.InvariantCulture：根據固定文化排序，不參考系統文化。</li>
<li>StringComparer.InvariantCultureIgnoreCase：根據固定文化排序，不參考系統文化，忽略大小寫。</li>
</ol>
<pre><code class="language-csharp">void Main()
{
	var words = new List&lt;string&gt;() { &quot;i&quot;, &quot;love&quot;, &quot;csharp&quot;, &quot;i&quot;, &quot;love&quot;, &quot;sorting&quot; };
	words.Sort(StringComparer.Ordinal);
	foreach (var element in words)
	{
		Console.WriteLine(element);
	}
}

// 輸出
csharp
i
i
love
love
sorting
</code></pre>
<p>我們這邊再把第一個 love 改成大寫形式，在進行排序會發現大寫的 Love 變到第一位了，這是因為大寫的 <code>L</code> 為 76 小寫的 <code>c</code> 為 99
所以這時就會把 Love 拉到第一位</p>
<pre><code class="language-csharp">void Main()
{
	var words = new List&lt;string&gt;(){ &quot;i&quot;, &quot;Love&quot;, &quot;csharp&quot;, &quot;i&quot;, &quot;love&quot;, &quot;sorting&quot;};
	words.Sort(StringComparer.Ordinal);
	foreach (var element in words)
	{
		Console.WriteLine(element);
	}
}

// 輸出
Love
csharp
i
i
love
sorting
</code></pre>
<p>當然也可使用 StringComparer.OrdinalIgnoreCase 也是以 ASCII 為基礎但是會忽略掉大小寫</p>
<pre><code class="language-csharp">void Main()
{
	var words = new List&lt;string&gt;() { &quot;i&quot;, &quot;love&quot;, &quot;csharp&quot;, &quot;i&quot;, &quot;love&quot;, &quot;sorting&quot; };
	words.Sort(StringComparer.OrdinalIgnoreCase);
	foreach (var element in words)
	{
		Console.WriteLine(element);
	}
}

// 輸出
csharp
i
i
love
love
sorting
</code></pre>
<hr />
<p>使用多條件排序(單字出現頻率 + ASCII) 搭配 LINQ，最後挑選前兩名。</p>
<pre><code class="language-text">void Main()
{
	var words = new List&lt;string&gt; { &quot;love&quot;, &quot;i&quot;, &quot;csharp&quot;, &quot;love&quot;, &quot;i&quot;, &quot;sorting&quot;, &quot;sorting&quot;, &quot;sorting&quot; };

	// 統計每個單字的出現頻率
	var freqMap = words
		.GroupBy(w =&gt; w)
		.ToDictionary(g =&gt; g.Key, g =&gt; g.Count());

	// 多條件排序：先依頻率再依 ASCII 字母排序
	var topTwo = freqMap
		.OrderByDescending(kv =&gt; kv.Value)             // 依頻率排序
		.ThenBy(kv =&gt; kv.Key, StringComparer.Ordinal)  // 頻率相同時依 ASCII 排序
		.Take(2)                                       // 取前兩名
		.Select(kv =&gt; kv.Key)                          // 只取 Key
		.ToList();

	// 輸出結果
	topTwo.ForEach(Console.WriteLine);
}
</code></pre>
<hr />
<p>在 .Net 10 提供了 CompareOptions 讓建立比較器更加容易，例如 <code>CompareOptions.NumericOrdering</code>，
適合用來排序文字中帶有數字的資料。</p>
<pre><code class="language-text">void Main()
{
	var words = new List&lt;string&gt; { &quot;file2&quot;, &quot;file1&quot;, &quot;file4&quot;, &quot;file3&quot;};

	var comparer = StringComparer.Create(
        CultureInfo.InvariantCulture,
        CompareOptions.NumericOrdering);
	
	var sorted = words.OrderBy(x =&gt; x, comparer);
	sorted.ToList().ForEach(Console.WriteLine);
}
</code></pre>


          

        </div>
      </div>
  <div id="comments-container" class="row">
    <div id="giscus-container"></div>

<script>
  let giscusLoaded = false;
  function loadGiscus() {
    if (giscusLoaded) return;
    giscusLoaded = true;

    let datarepo = 'allengaodev/allengaodev.github.io'
    let datarepoid='R_kgDOI6sF8g'
    let datacategoryid='DIC_kwDOI6sF8s4CUbuw'
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.setAttribute('data-repo', datarepo);
    script.setAttribute('data-repo-id', datarepoid);
    script.setAttribute('data-category-id', datacategoryid);
    script.setAttribute("data-mapping", "pathname");
    script.setAttribute("data-strict", "0");
    script.setAttribute("data-reactions-enabled", "1");
    script.setAttribute("data-emit-metadata", "0");
    script.setAttribute("data-input-position", "top");
    script.setAttribute("data-theme", "light");
    script.setAttribute("data-lang", "en");
    script.async = true;
    document.getElementById("giscus-container").appendChild(script);
  }

  // 檢查是否滾動到最底部
  function checkScrollBottom() {
    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight / 2) {
      loadGiscus();
      window.removeEventListener("scroll", checkScrollBottom);
    }
  }

  // 等待滾動結束
  setTimeout(() => {
    checkScrollBottom();
    window.addEventListener("scroll", checkScrollBottom);
  }, 500); // 0.5秒後檢查
</script>

  </div>
    </div>
  </main>

  <hr>

  <!-- Footer -->
  <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="copyright">&#xA9; 2025 by Allen Gao</p>

      </div>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script async src='/vendor/bootstrap/js/bootstrap.bundle.min.js'></script>
  <script async src='/vendor/startbootstrap-clean-blog/js/scripts.js'></script>
  <script async src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script async src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script async src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js" onload="quicklink.listen();"></script>
  

  
</body>

</html>
