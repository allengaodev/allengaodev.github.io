<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preload" as="style" href='/scss/clean-blog-min.css'/>

    <meta name="description" content="&#x672C;&#x7BC7;&#x6559;&#x5B78;&#x8A73;&#x89E3;&#x5982;&#x4F55;&#x5BE6;&#x4F5C; Installer &#x5B89;&#x88DD;&#x5668;&#xFF0C;&#x5C07; .abpmdl &#x8207; .abppkg &#x5B9A;&#x7FA9;&#x6A94;&#x5C01;&#x88DD;&#x81F3; NuGet &#x5957;&#x4EF6;&#xFF0C;&#x4E26;&#x900F;&#x904E; ABP CLI &#x9054;&#x6210;&#x7B2C;&#x4E09;&#x65B9;&#x6A21;&#x7D44;&#x7684;&#x81EA;&#x52D5;&#x5316;&#x5B89;&#x88DD;&#x8207;&#x767C;&#x4F48;&#x6D41;&#x7A0B;&#xFF0C;&#x63D0;&#x5347;&#x6A21;&#x7D44;&#x5316;&#x958B;&#x767C;&#x6548;&#x7387;&#x3002;">

  <title>ABP IO &#x6559;&#x5B78; | &#x6A21;&#x7D44;&#x5316;&#x67B6;&#x69CB;&#x5165;&#x9580;&#xFF1A;&#x767C;&#x4F48;&#x8207;&#x5B89;&#x88DD;&#x5668; - Part 8</title>


  <link rel="canonical" href='https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-installer'>

      <link type="application/rss+xml" rel="alternate" title="&#x958B;&#x767C;&#x7A7A;&#x9593;" href="/feed.rss" />
      <link type="application/atom+xml" rel="alternate" title="&#x958B;&#x767C;&#x7A7A;&#x9593;" href="/feed.atom" />

  <meta name="application-name" content='Gao.Dev' />
  <meta name="msapplication-tooltip" content='Gao.Dev' />
  <meta name="msapplication-starturl" content='/' />
  <meta name="google-site-verification" content="aq71qXzppLuXZ8be8mjOwn_zJq317ZSD34yTS4i6y6M" />
  <meta property="og:title" content='ABP IO &#x6559;&#x5B78; | &#x6A21;&#x7D44;&#x5316;&#x67B6;&#x69CB;&#x5165;&#x9580;&#xFF1A;&#x767C;&#x4F48;&#x8207;&#x5B89;&#x88DD;&#x5668; - Part 8' />
  <meta property="og:type" content="website" />
  <meta property="og:url" content='https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-installer' />

  <link rel="icon" href='/favicon.svg'>

  <!-- Styles for this template (also includes Bootstrap) -->
  <link href='/scss/clean-blog-min.css' rel="stylesheet">

  


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand navbar-light" id="mainNav" style="background-color: #F5F1E6">
  <div class="container">
    <a class="navbar-brand text-dark" href='/'> Home </a>

    <div class="navbar-nav-container" id="navbarResponsive">
      <ul class="navbar-nav ms-auto">
          <li class="nav-item">
    <a class="nav-link text-dark" href="/search">Search</a>
  </li>
  <li class="nav-item">
    <a class="nav-link text-dark" href="/posts">Posts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link text-dark" href="/tags">Tags</a>
  </li>

      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->
  <header class="masthead no-image">
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12">
        <div class='post-heading'>
          <h1>
            <a style="color:white" href='https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-installer'>ABP IO &#x6559;&#x5B78; | &#x6A21;&#x7D44;&#x5316;&#x67B6;&#x69CB;&#x5165;&#x9580;&#xFF1A;&#x767C;&#x4F48;&#x8207;&#x5B89;&#x88DD;&#x5668; - Part 8</a>
          </h1>
            <p class="post-meta">
              <a style="line-height: 1.8em;padding-left: 1.6em;background-size: auto 100%;background-repeat: no-repeat; background-image:url(/calendar.svg)">
                2025/12/31
              </a>

            </p>
              <div class="mt-3">
                  <a href="/tags/abp" class="badge bg-white text-dark"> ABP</a>
              </div>
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <main id="main-content">
    <div class="container">
      <div class="row">
        <div id="content" class="col-md-12">
          <h2 id="section">文章系列</h2>
<ul>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-module-design-and-lifecycle" target="_blank"><u>01.模組化架構入門：設計與實踐 - Part 1</u></a></strong></li>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-domain-layer" target="_blank"><u>02.模組化架構入門：領域層級 - Part 2</u></a></strong></li>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-infrastructure-layer" target="_blank"><u>03.模組化架構入門：基礎設施層 - Part 3</u></a></strong></li>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-application-http-layer" target="_blank"><u>04.模組化架構入門：應用層與 HTTP 層 - Part 4</u></a></strong></li>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-host-layer" target="_blank"><u>05.模組化架構入門：Host 層 - Part 5</u></a></strong></li>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-http-client" target="_blank"><u>06.模組化架構入門：Http Client - Part 6</u></a></strong></li>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-install" target="_blank"><u>07.模組化架構入門：安裝模組 - Part 7</u></a></strong></li>
<li><strong><a href="https://blog.allengaodev.com/posts/abp-io-tutorials-from-scratch-installer" target="_blank"><u>08.模組化架構入門：發佈與安裝器 - Part 8</u></a></strong></li>
</ul>
<h2 id="section-1"><br><br></h2>
<h2 id="section-2">目錄</h2>
<ul>
  <li><a href="#安裝器實做">安裝器實做</a></li>
  <li><a href="#發佈模組">發佈模組</a></li>
  <li><a href="#安裝-nuget-上的模組">安裝 Nuget 上的模組</a></li>
</ul>
<h2 id="section-3"><br><br></h2>
<h2 id="section-4">安裝器實做</h2>
<p>在上一篇文章中有介紹手動與本地自動安裝的流程，除此之外還有第三種就是透過安裝器，它的特點就是透過一個獨立的
<code>Installer</code> 將建立好的 <code>abppkg</code> 與 <code>abpmdl</code> 文件打包成 <code>Installer.nupkg</code> 檔案並上傳到 Nuget。</p>
<p>之後透過命令 <code>abp install-module</code>，ABP 背後會去 Nuget 下載回 <code>Installer.nupkg</code>，並根據內部的 <code>abpmdl</code> 並下載所有依賴的函式庫，
最後再根據函式庫內 <code>abppkg</code> 定義的角色決定安裝流程。</p>
<p>首先建立新專案 <code>BookStoreScratch.Installer</code></p>
<pre><code class="language-text">dotnet new classlib -o src/BookStoreScratch.Installer
dotnet sln add src/BookStoreScratch.Installer
mkdir src/BookStoreScratch.Installer/BookStoreScratch
rm src/BookStoreScratch.Installer/Class1.cs
touch src/BookStoreScratch.Installer/BookStoreScratch/BookStoreScratchInstallerModule.cs
</code></pre>
<p>調整專案設定檔，確定 <code>abpmdl</code> 與所有 <code>abppkg</code> 都嵌入在內，最後 ABP 透過 dll 加載，因此需要安裝 <code>Volo.Abp.VirtualFileSystem</code>。</p>
<pre><code class="language-text">&lt;Project Sdk=&quot;Microsoft.NET.Sdk&quot;&gt;
    &lt;PropertyGroup&gt;
        &lt;TargetFramework&gt;net9.0&lt;/TargetFramework&gt;
        &lt;GenerateEmbeddedFilesManifest&gt;true&lt;/GenerateEmbeddedFilesManifest&gt;
        &lt;RootNamespace /&gt;
    &lt;/PropertyGroup&gt;

    &lt;ItemGroup&gt;
        &lt;PackageReference Include=&quot;Volo.Abp.VirtualFileSystem&quot; Version=&quot;9.0.2&quot; /&gt;
    &lt;/ItemGroup&gt;

    &lt;ItemGroup&gt;
        &lt;!-- Embed module definition file --&gt;
        &lt;Content Include=&quot;..\..\BookStoreScratch.abpmdl&quot;&gt;
            &lt;Pack&gt;true&lt;/Pack&gt;
            &lt;PackagePath&gt;content\&lt;/PackagePath&gt;
        &lt;/Content&gt;
        
        &lt;!-- Embed package definition files --&gt;
        &lt;Content Include=&quot;..\..\**\*.abppkg*&quot;&gt;
            &lt;Pack&gt;true&lt;/Pack&gt;
            &lt;PackagePath&gt;content\&lt;/PackagePath&gt;
        &lt;/Content&gt;
    &lt;/ItemGroup&gt;
&lt;/Project&gt;
</code></pre>
<pre><code class="language-text">using Volo.Abp.Modularity;
using Volo.Abp.VirtualFileSystem;

namespace BookStoreScratch;

[DependsOn(typeof(AbpVirtualFileSystemModule))]
public class BookStoreScratchInstallerModule : AbpModule
{
    public override void ConfigureServices(ServiceConfigurationContext context)
    {
        Configure&lt;AbpVirtualFileSystemOptions&gt;(options =&gt;
        {
            options.FileSets.AddEmbedded&lt;BookStoreScratchInstallerModule&gt;();
        });
    }
}
</code></pre>
<h2 id="section-5"><br><br></h2>
<h2 id="section-6">發佈模組</h2>
<p>接下來處理模組的發佈流程，最常見的就是直接發佈到 Nuget 上，將模組內必要的組件都打包到 <code>nupkgs</code> 底下。</p>
<pre><code class="language-text">dotnet pack src/BookStoreScratch.Application/BookStoreScratch.Application.csproj -c Release -o ./nupkgs
dotnet pack src/BookStoreScratch.Application.Contracts/BookStoreScratch.Application.Contracts.csproj -c Release -o ./nupkgs
dotnet pack src/BookStoreScratch.Domain/BookStoreScratch.Domain.csproj -c Release -o ./nupkgs
dotnet pack src/BookStoreScratch.Domain.Shared/BookStoreScratch.Domain.Shared.csproj -c Release -o ./nupkgs
dotnet pack src/BookStoreScratch.EntityFrameworkCore/BookStoreScratch.EntityFrameworkCore.csproj -c Release -o ./nupkgs
dotnet pack src/BookStoreScratch.HttpApi/BookStoreScratch.HttpApi.csproj -c Release -o ./nupkgs
dotnet pack src/BookStoreScratch.HttpApi.Client/BookStoreScratch.HttpApi.Client.csproj -c Release -o ./nupkgs
dotnet pack src/BookStoreScratch.Installer/BookStoreScratch.Installer.csproj -c Release -o ./nupkgs
</code></pre>
<p>將 <code>nupkgs</code> 底下所有檔案都推送到 nuget 上，注意要帶入自己的 <code>api-key</code></p>
<pre><code class="language-text">for f in *.nupkg; do dotnet nuget push &quot;$f&quot; --api-key &lt;api-key&gt; --source https://api.nuget.org/v3/index.json; done
</code></pre>
<p>完成後等待一段時間，確認所有組件都在 Published 就成功了。</p>
<h2 id="section-7"><br><br></h2>
<h2 id="nuget">安裝 Nuget 上的模組</h2>
<p>安裝官方模組只需要透過 <code>abp install-module</code> 即可，但是它只支援官方定義過的模組，所以我們這種第三方的模組需要多幾個額外步驟。</p>
<p>首先要使用命令新增模組來源。</p>
<pre><code class="language-text">abp add-module-source -n &quot;MyRepo&quot; -p &quot;E:\Project\BookStoreScratch\BookStoreScratch\modules.json&quot;
</code></pre>
<pre><code class="language-text">{
  &quot;name&quot;: &quot;My Source Modules&quot;,
  &quot;modules&quot;: {
    &quot;BookStoreScratch&quot;: {
      &quot;name&quot;: &quot;BookStoreScratch&quot;,
      &quot;description&quot;: &quot;自定義書店模組&quot;
    }
  }
}
</code></pre>
<p>接下來就能在 <code>abp list-modules</code> 看到新的模組出現，背後是根據 <code>NuGet.Config</code> 的順序執行查詢</p>
<pre><code class="language-text">$ abp list-modules

Checking extensions...
...
&gt; Volo.CmsKit
&gt; Volo.Docs
&gt; BookStoreScratch
</code></pre>
<p>最後建立測試專案</p>
<pre><code class="language-text">abp new Acme.UniStore -dbms PostgreSQL --skip-migrations
</code></pre>
<p>改用 <code>install-module</code> 命令，ABP 會自動搜尋 <code>BookStoreScratch.Installer</code> 是否存在。</p>
<pre><code class="language-text">abp install-module BookStoreScratch
</code></pre>
<p>執行完後會發現所有添加參考與添加 <code>DependsOn</code> 的工作全部都自動處理了。</p>
<p>今天的進度 <a href="https://github.com/allengaodev/BookStoreScratch/tree/1.8" target="_blank">Github</a></p>


          

        </div>
      </div>
  <div id="comments-container" class="row">
    <div id="giscus-container"></div>

<script>
  let giscusLoaded = false;
  function loadGiscus() {
    if (giscusLoaded) return;
    giscusLoaded = true;

    let datarepo = 'allengaodev/allengaodev.github.io'
    let datarepoid='R_kgDOI6sF8g'
    let datacategoryid='DIC_kwDOI6sF8s4CUbuw'
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.setAttribute('data-repo', datarepo);
    script.setAttribute('data-repo-id', datarepoid);
    script.setAttribute('data-category-id', datacategoryid);
    script.setAttribute("data-mapping", "pathname");
    script.setAttribute("data-strict", "0");
    script.setAttribute("data-reactions-enabled", "1");
    script.setAttribute("data-emit-metadata", "0");
    script.setAttribute("data-input-position", "top");
    script.setAttribute("data-theme", "light");
    script.setAttribute("data-lang", "en");
    script.async = true;
    document.getElementById("giscus-container").appendChild(script);
  }

  // 檢查是否滾動到最底部
  function checkScrollBottom() {
    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight / 2) {
      loadGiscus();
      window.removeEventListener("scroll", checkScrollBottom);
    }
  }

  // 等待滾動結束
  setTimeout(() => {
    checkScrollBottom();
    window.addEventListener("scroll", checkScrollBottom);
  }, 500); // 0.5秒後檢查
</script>

  </div>
    </div>
  </main>

  <hr>

  <!-- Footer -->
  <footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12 text-center">
        <p class="copyright">&#xA9; 2026 by Allen Gao</p>

      </div>
    </div>
  </div>
</footer>


  <!-- Scripts -->
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"></script>
  <script async src="https://cdn.jsdelivr.net/npm/quicklink@2.3.0/dist/quicklink.umd.js"></script>
  <script defer src='/vendor/startbootstrap-clean-blog/js/scripts.min.js'></script>
  

  
</body>

</html>
